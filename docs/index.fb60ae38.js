!function(){function n(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function t(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})))),o.forEach((function(e){n(t,e,r[e])}))}return t}function e(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function r(n){if(Array.isArray(n))return e(n)}function o(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(n,t){if(n){if("string"==typeof n)return e(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(n,t):void 0}}function c(n){return r(n)||o(n)||u(n)||i()}var a=function(n){return document.createElement(n)},l=function(n){return document.querySelector(n)},f=function(n){return n.classList},d=function(n,t,e){return n.setAttribute(t,e)},s=function(n,t){return n.getAttribute(t)},v=function(n,t,e){return n.addEventListener(t,e)},h=function(n,t,e){return n.style.setProperty(t,e)},b=function(n,t){return window.localStorage.setItem(n,t)},m="MAIN_MENU",p="LEVEL_SELECTION_MENU",y="RANDOM_LEVEL_SELECTION_MENU",E="PREDEFINED_LEVEL_SELECTION_MENU",g="COLOR_SETTINGS",w="GAME",L="RESET_MENU",k="WINNER_MENU",I="LAZY_EYE_SETTINGS_MENU",S="LEFT_EYE_SETTINGS_MENU",C="RIGHT_EYE_SETTINGS_MENU",_="light",N="dark",O="lazy",T="cell",M="flipped_cell",A="board",j="menu",R="menu-title",U="menu-title-item",x="status-line-button",B="background-color",P="border-bottom",z="outline",D="outline-offset",G="color",H={currentLevelId:0,finishedLevelIds:[],location:m,board:[],moves:[],solution:[],pattern:null,theme:_,leftEyeColor:"red",rightEyeColor:"blue"},Y=t({},H),V=[];function q(n,t){Object.assign(Y,n);var e=Object.keys(n);t&&V.forEach((function(n){var t=n.properties,r=n.callback;(t.some((function(n){return e.includes(n)}))||0===t.length)&&r(Y)}))}function F(n){q(n,!0)}function J(n){q(n,!1)}function W(){return Y}function X(n,t,e){var r=Object.keys(Y);n.forEach((function(n){if(!r.includes(n))throw new Error("".concat(n," is not key in the state."))})),V.push({properties:n,callback:t,name:e})}function Z(n){V=V.filter((function(t){return t.name!==n}))}function $(n){if(Array.isArray(n))return n}function K(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Q(n,t){return $(n)||o(n)||u(n,t)||K()}var nn,tn,en,rn,on,un="row_index",cn="column_index",an="5px",ln="2px",fn="fff02259-20e4-4f4b-9a97-71f7c88f5d79",dn=20,sn=function(){return W().leftEyeColor},vn=function(){return W().rightEyeColor},hn=(n(rn={},_,(n(nn={},j,[[B,"white"]]),n(nn,R,[[G,"black"],[P,"1vh solid black"]]),n(nn,U,[[G,"black"],[z,"".concat(an," solid black")],[D,"-".concat(an)]]),n(nn,T,[[B,"white"],[z,"".concat(an," solid black")],[D,"-".concat(an)]]),n(nn,M,[[B,"black"]]),n(nn,A,[[B,"white"]]),n(nn,x,[[z,"".concat(ln," solid black")],[D,"-".concat(ln)]]),nn)),n(rn,N,(n(tn={},j,[[B,"black"]]),n(tn,R,[[G,"white"],[P,"1vh solid white"]]),n(tn,U,[[G,"white"],[z,"".concat(an," solid white")],[D,"-".concat(an)]]),n(tn,T,[[B,"black"],[z,"".concat(an," solid white")],[D,"-".concat(an)]]),n(tn,M,[[B,"white"]]),n(tn,A,[[B,"black"]]),n(tn,x,[[G,"white"],[z,"".concat(ln," solid white")],[D,"-".concat(ln)]]),tn)),n(rn,O,(n(en={},j,[[B,"black"]]),n(en,R,[[G,sn],[P,function(){return"1vh solid ".concat(vn())}]]),n(en,U,[[G,sn],[z,function(){return"".concat(ln," solid ").concat(vn())}],[D,"-".concat(ln)]]),n(en,T,[[B,sn]]),n(en,M,[[B,vn]]),n(en,A,[[B,"black"]]),n(en,x,[[G,sn],[z,function(){return"".concat(ln," solid ").concat(vn())}],[D,"-".concat(ln)]]),en)),rn),bn=function(n,t){return hn[t]&&hn[t][n]?hn[t][n]:[]},mn=function(n,t){Object.values(hn).forEach((function(t){Object.values(t).forEach((function(t){for(var e=0;e<t.length;e+=1)n.style[t[e][0]]=""}))})),t.forEach((function(t){var e=Q(t,2),r=e[0],o=e[1],i="function"==typeof o?o():o;h(n,r,i)}))},pn="whole_cross",yn="small_cross",En="inverted_cross",gn="random",wn=(n(on={},pn,(function(n,t){return function(e,r){for(var o=function(n){i.some((function(t){var r=Q(t,2),o=r[0],i=r[1];return o===e&&i===n}))||i.push([e,n])},i=[],u=0;u<n;u+=1)i.push([u,r]);for(var c=0;c<t;c+=1)o(c);return i}})),n(on,yn,(function(n,t){return function(e,r){return[[0,0],[-1,0],[1,0],[0,-1],[0,1]].filter((function(o){return o[0]+e<n&&o[1]+r<t})).filter((function(n){return n[0]+e>=0&&n[1]+r>=0})).map((function(n){return[n[0]+e,n[1]+r]}))}})),n(on,En,(function(n,t){return function(e,r){return[[0,0],[-1,-1],[-1,1],[1,-1],[1,1]].filter((function(o){return o[0]+e<n&&o[1]+r<t})).filter((function(n){return n[0]+e>=0&&n[1]+r>=0})).map((function(n){return[n[0]+e,n[1]+r]}))}})),n(on,gn,(function(n,t){var e=Object.keys(wn).filter((function(n){return n!==gn})),r=e[Math.floor(Math.random()*e.length)];return wn[r](n,t)})),on),Ln=function(n,t,e,r){var o=wn[e](r.length,r[0].length),i=r.map((function(n){return n.map((function(n){return n}))}));return o(n,t).forEach((function(n){var t=Q(n,2),e=t[0],o=t[1];i[e][o]=!r[e][o]})),i},kn=function(n,t,e){var r=e.board,o=e.pattern,i=e.moves;return{board:Ln(n,t,o,r),moves:c(i).concat([[n,t]])}},In=function(n){var t=n.board,e=n.pattern,r=n.moves;if(0===r.length)return{board:t,moves:r};var o=c(r),i=Q(o.pop(),2),u=i[0],a=i[1];return{board:Ln(u,a,e,t),moves:o}},Sn=function(n){for(var t=n.board,e=n.pattern,r=c(n.moves),o=t.map((function(n){return n.map((function(n){return n}))}));r.length>0;){var i=In({board:o,pattern:e,moves:r});o=i.board,r=i.moves}return{board:o,moves:r}},Cn=[{id:10,board:[[!1,!0,!0,!0],[!1,!0,!0,!0],[!1,!0,!0,!0],[!1,!1,!1,!1]],solution:[[3,0]],pattern:pn},{id:20,board:[[!1,!0,!0,!1],[!0,!0,!0,!0],[!0,!0,!0,!0],[!1,!0,!0,!1]],solution:[[3,0],[0,0],[0,3],[3,3]],pattern:pn},{id:30,board:[[!0,!0,!0,!0],[!0,!1,!1,!0],[!0,!1,!1,!0],[!0,!0,!0,!0]],solution:[[1,1],[1,2],[2,2],[2,1]],pattern:pn},{id:40,board:[[!0,!1,!0,!0],[!1,!0,!0,!0],[!0,!0,!0,!1],[!0,!0,!1,!0]],solution:[[1,0],[2,3],[3,2],[0,1]],pattern:pn},{id:50,board:[[!0,!0,!0,!1],[!0,!0,!1,!0],[!0,!1,!0,!0],[!1,!0,!0,!0]],solution:[[3,0],[2,1],[1,2],[0,3]],pattern:pn},{id:60,board:[[!0,!0,!0,!0],[!1,!0,!1,!0],[!0,!1,!0,!0],[!1,!0,!1,!0]],solution:[[3,0],[2,0],[3,1],[3,2],[2,1],[1,0],[1,1],[2,2],[2,3],[1,2],[0,1]],pattern:pn},{id:70,board:[[!1,!1,!1,!1],[!1,!0,!0,!1],[!1,!0,!0,!1],[!0,!1,!1,!1]],solution:[[0,1],[0,2],[0,3],[1,3],[2,3]],pattern:pn},{id:80,board:[[!0,!0,!0,!0],[!0,!1,!1,!0],[!0,!1,!0,!0],[!0,!0,!0,!0]],solution:[[3,2],[2,3],[0,2],[1,1],[2,0]],pattern:pn},{id:90,board:[[!0,!1,!1,!0],[!1,!0,!0,!1],[!1,!0,!0,!1],[!0,!1,!1,!0]],solution:[[1,0],[0,1],[0,2],[1,3],[2,3],[3,2],[3,1],[2,0]],pattern:pn},{id:100,board:[[!0,!0,!0,!0],[!0,!0,!0,!0],[!0,!0,!0,!0],[!0,!0,!0,!1]],solution:[[0,3],[1,3],[2,3],[3,3],[3,0],[3,1],[3,2],[3,3],[3,3]],pattern:pn},{id:110,board:[[!0,!0,!1,!0,!0],[!0,!1,!1,!1,!0],[!1,!1,!1,!1,!1],[!0,!1,!1,!1,!0],[!0,!0,!1,!0,!0]],solution:[[3,3],[1,3],[1,1],[3,1],[2,2]],pattern:pn},{id:120,board:[[!0,!1,!0,!1,!0],[!1,!1,!0,!1,!1],[!0,!0,!0,!0,!0],[!1,!1,!0,!1,!1],[!0,!1,!0,!1,!0]],solution:[[3,1],[2,2],[1,3],[3,3],[2,2],[1,1],[1,0],[0,1],[4,3],[3,4],[1,4],[0,3],[4,1],[3,0]],pattern:pn},{id:130,board:[[!1,!0,!0,!1,!0],[!0,!0,!1,!0,!1],[!0,!1,!0,!1,!0],[!1,!0,!1,!0,!0],[!0,!1,!0,!0,!1]],solution:[[0,0],[0,1],[1,0],[4,3],[4,4],[3,4]],pattern:pn},{id:140,board:[[!0,!1,!1,!1,!0],[!0,!1,!1,!1,!0],[!1,!0,!1,!0,!1],[!1,!1,!1,!1,!1],[!1,!0,!1,!0,!1]],solution:[[3,1],[2,2],[3,3],[4,2],[3,2]],pattern:pn},{id:150,board:[[!1,!0,!1,!0,!1],[!0,!1,!1,!1,!0],[!1,!1,!1,!1,!1],[!0,!1,!1,!1,!0],[!1,!0,!1,!0,!1]],solution:[[4,4],[3,3],[1,3],[0,4],[3,1],[4,0],[1,1],[0,0],[2,2]],pattern:pn}],_n=function(n,t,e,r){return{rows:n,columns:t,stepsToSolve:e,pattern:r}},Nn=_n(4,4,5,pn),On=_n(5,5,10,pn),Tn=_n(7,7,20,pn),Mn=function(n,t,e){var r=function(n){return Math.floor(Math.random()*n)};return c(Array(n)).map((function(){return[r(t),r(e)]}))},An=function(n){var e=function(n){for(var t=n.rows,e=n.columns,r=n.stepsToSolve,o=n.pattern,i=c(Array(t)).map((function(){return Array(e).fill(!0)})),u=Mn(r,t,e),a=0;a<u.length;a+=1){var l=Q(u[a],2),f=l[0],d=l[1];i=Ln(f,d,o,i)}return{board:i,solution:u,pattern:o}}(t({},n)),r=e.board;F({solution:e.solution,pattern:e.pattern,currentLevelId:0,moves:[]}),J({board:r})},jn=function(){return Cn},Rn=function(n,t,e){var r=e.filter((function(n){return!t.includes(n.id)}));if(0===r.length)return null;var o=r.find((function(t){return t.id>n}));return void 0!==o?o:r[0]},Un=function(n){var t=n.board;F({solution:n.solution,pattern:n.pattern,currentLevelId:n.id,moves:[]}),J({board:t})},xn=function(n){return F({location:n})},Bn=function(n){return F({theme:n})},Pn=function(n,t){var e=t.width,r=t.height,o=t.margin;h(n,"width",e),h(n,"height",r),h(n,"margin",o)},zn=function(n){var t=n.length,e=window.innerWidth<window.innerHeight?"vw":"vh",r=Math.floor(90/t*.95);return{margin:.05*r+e,width:r+e,height:r+e}},Dn=function(n){var e,r,o=n.target,i=W(),u=parseInt(s(o,un),10),a=parseInt(s(o,cn),10);if(F(t({},kn(u,a,i))),W().board.every((function(n){return n.every((function(n){return n}))}))){var l=i.finishedLevelIds,f=i.currentLevelId;l.includes(f)||J({finishedLevelIds:c(l).concat([i.currentLevelId])}),Z("board-theme-observer"),Z("cell-board-observer"),e=function(){return xn(k)},r=500,window.setTimeout(e,r)}},Gn=function(n,t){return mn(n,bn(A,t))},Hn=function(n,t,e){mn(n,bn(t?T:M,e))},Yn=function(){var n=function(n){var o=function(e){var o=a("div");f(o).add("cell"),d(o,un,n),d(o,cn,e),v(o,"click",Dn),Pn(o,zn(r)),Hn(o,t.board[n][e],t.theme),X(["board"],(function(t){return Hn(o,t.board[n][e],t.theme)}),"cell-board-observer"),i.appendChild(o)},i=a("div");f(i).add("row");for(var u=0;u<r[n].length;u+=1)o(u);e.appendChild(i)};Z("board-theme-observer"),Z("cell-board-observer");var t=W(),e=a("div");f(e).add("board"),Gn(e,t.theme),X(["theme"],(function(n){var t=n.theme;return Gn(e,t)}),"board-theme-observer");for(var r=W().board,o=0;o<r.length;o+=1)n(o);return e},Vn=function(){var n;(n=".cell",document.querySelectorAll(n)).forEach((function(n){var t=W().board;Pn(n,zn(t))}))},qn={currentLocation:null,map:{}};function Fn(n,t){Object.assign(qn.map,t);X(["location"],(function(n){var t=n.location;if(t!==qn.currentLocation){var e=l("#root");e.innerHTML="";var r=qn.map[t];r="function"==typeof r?r():r,e.appendChild(r),qn.currentLocation=t}})),F({location:n})}function Jn(n){var t=a("div");return f(t).add("ui-menu"),n&&n.forEach((function(n){return t.appendChild(n)})),mn(t,bn(j,W().theme)),X(["theme"],(function(n){var e=n.theme;mn(t,bn(j,e))}),"menu-theme-observer"),t}function Wn(n,t){var e=a("button");return e.innerText=n,e.onclick=t,f(e).add("ui-menu-item"),mn(e,bn(U,W().theme)),X(["theme"],(function(n){var t=n.theme;mn(e,bn(U,t))}),"menu-item-theme-observer"),e}function Xn(n){var t=a("button");return t.innerText=n,t.disabled=!0,f(t).add("ui-menu-title"),mn(t,bn(R,W().theme)),X(["theme"],(function(n){var e=n.theme;mn(t,bn(R,e))}),"menu-theme-observer"),t}var Zn=function(n){var t=255/(dn/2);return n<dn/2?"rgb(".concat(255-n*t,",0,0)"):"rgb(0,0,".concat((n-dn/2)*t,")")},$n=function(n,t){for(var e=t/(dn+1),r=1;n>e*r;)r+=1;return Zn(r-1)};function Kn(n){var t=a("canvas");f(t).add("color-picker");for(var e=t.getContext("2d"),r=t.width/(dn+1),o=0;o<=dn;o+=1)e.fillStyle=Zn(o),e.fillRect(o*r,0,r,t.height);return v(t,"click",(function(e){var r=e.clientX;if(t){var o=t.getBoundingClientRect(),i=o.left,u=o.width,c=$n(r-i,u);n(c)}})),t}function Qn(n){var t=a("canvas");return f(t).add("color-indicator"),X([],(function(e){if(t){var r=n(e),o=t.getContext("2d");o.fillStyle=r,o.fillRect(0,0,t.width,t.height)}})),t}function nt(n,t){var e=a("button");return f(e).add("status-line-button"),e.innerHTML=n,e.onclick=t,mn(e,bn(x,W().theme)),e}var tt=function(){var n=W();F(t({},In(n)))};function et(){var n=a("div");return f(n).add("status-line"),n.appendChild(nt("back",(function(){return xn(m)}))),n.appendChild(nt("undo",tt)),n.appendChild(nt("reset",(function(){return xn(L)}))),n}function rt(){var n=a("div");return h(n,"height","100%"),n.appendChild(Yn()),n.appendChild(et()),n}function ot(){var n,t=Jn();return t.appendChild(Xn("Renverso")),t.appendChild(Wn("New game",(function(){return xn(p)}))),t.appendChild((n=Wn("Continue",(function(){return xn(w)})),h(n,"display","none"),X(["pattern"],(function(t){var e=t.pattern;h(n,"display",null===e?"none":"block")})),n)),t.appendChild(Wn("Color theme",(function(){return xn(g)}))),t}var it=function(){var n=W();F(t({},Sn(n))),xn(w)};var ut=function(){F({board:[],moves:[],solution:[],pattern:null,location:m})},ct=function(n){return"move".concat(n.length>1?"s":"")},at=function(){var n=W(),t=n.currentLevelId,e=n.finishedLevelIds,r=Rn(t,e,jn());null!==r&&(Un(r),xn(w))};var lt=function(n){An(n),xn(w)};var ft=function(){var n=a("div");f(n).add("ui-level-selector-container"),mn(n,bn(U,W().theme)),X(["theme"],(function(t){var e=t.theme;mn(n,bn(U,e))}),"menu-item-theme-observer");var t=W().finishedLevelIds;return jn().map((function(n,e){var r=t.includes(n.id)?" (done)":"",o=Wn("Level ".concat(e+1).concat(r),(function(){return function(n){Un(n),xn(w)}(n)}));return f(o).remove("ui-menu-item"),f(o).add("ui-level-selector-button"),o})).forEach((function(t){return n.appendChild(t)})),n};window.onresize=function(){Vn()},window.onload=function(){var e,r=(n(e={},w,(function(){return rt()})),n(e,m,ot()),n(e,L,Jn([Xn("Do you want to reset level progress?"),Wn("Yes",(function(){return it()})),Wn("No",(function(){return xn(w)}))])),n(e,k,(function(){return n=W(),t=n.moves,e=n.currentLevelId,r=n.finishedLevelIds,o=Rn(e,r,jn()),i=[Xn("Puzzle solved in ".concat(t.length," ").concat(ct(t),"!")),Wn("To main menu",ut)],null!==o&&i.splice(1,0,Wn("Next level",at)),Jn(i);var n,t,e,r,o,i})),n(e,g,Jn([Xn("Select color theme"),Wn("Light",(function(){return Bn(_)})),Wn("Dark",(function(){return Bn(N)})),Wn("Lazy eye",(function(){return xn(I)})),Wn("Back",(function(){return xn(m)}))])),n(e,p,Jn([Xn("Select level"),Wn("Pick level",(function(){return xn(E)})),Wn("Random level",(function(){return xn(y)})),Wn("Back",(function(){return xn(m)}))])),n(e,I,Jn([Xn("Lazy eye coloring settings"),Wn("Left eye color",(function(){return xn(S)})),Wn("Right eye color",(function(){return xn(C)})),Wn("Apply",(function(){return Bn(O)})),Wn("Back",(function(){return xn(g)}))])),n(e,S,Jn([Xn("Left eye color"),Qn((function(n){return n.leftEyeColor})),Kn((function(n){return F({leftEyeColor:n})})),Wn("Back",(function(){return xn(I)}))])),n(e,C,Jn([Xn("Right eye color"),Qn((function(n){return n.rightEyeColor})),Kn((function(n){return F({rightEyeColor:n})})),Wn("Back",(function(){return xn(I)}))])),n(e,y,Jn([Xn("Select level"),Wn("Easy",(function(){return lt(Nn)})),Wn("Medium",(function(){return lt(On)})),Wn("Hard",(function(){return lt(Tn)})),Wn("Back",(function(){return xn(p)}))])),n(e,E,(function(){return Jn([Xn("Levels"),ft(),Wn("Back",(function(){return xn(p)}))])})),e);Fn(m,r);var o,i=(o=fn,window.localStorage.getItem(o));F(null!==i?t({},JSON.parse(i)):{theme:"light"}),X(Object.keys(W()),(function(n){return b(fn,JSON.stringify(n))}))}}();