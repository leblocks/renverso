!function(){function n(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function t(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{},o=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(e).filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})))),o.forEach((function(r){n(t,r,e[r])}))}return t}var r=function(n){return document.createElement(n)},e=function(n){return document.querySelector(n)},o=function(n){return n.classList},i=function(n,t,r){return n.setAttribute(t,r)},u=function(n,t){return n.getAttribute(t)},c=function(n,t,r){return n.addEventListener(t,r)},a=function(n,t,r){return n.style.setProperty(t,r)},l=function(n,t){return window.localStorage.setItem(n,t)},f="MAIN_MENU",d="LEVEL_SELECTION_MENU",s="COLOR_SETTINGS",h="GAME",v="RESET_MENU",m="WINNER_MENU",b="LAZY_EYE_SETTINGS_MENU",p="LEFT_EYE_SETTINGS_MENU",y="RIGHT_EYE_SETTINGS_MENU",g="light",w="dark",E="lazy",k="cell",S="flipped_cell",C="board",O="menu",T="menu-title",_="menu-title-item",A="status-line-button",N="background-color",L="border-bottom",M="outline",j="outline-offset",I="color",R={location:f,board:[],moves:[],solution:[],pattern:null,theme:g,leftEyeColor:"red",rightEyeColor:"blue"},x=t({},R),U=[];function z(n,t){Object.assign(x,n);var r=Object.keys(n);t&&U.forEach((function(n){var t=n.properties,e=n.callback;(t.some((function(n){return r.includes(n)}))||0===t.length)&&e(x)}))}function B(n){z(n,!0)}function G(){return x}function P(n,t,r){var e=Object.keys(x);n.forEach((function(n){if(!e.includes(n))throw new Error("".concat(n," is not key in the state."))})),U.push({properties:n,callback:t,name:r})}function H(n){U=U.filter((function(t){return t.name!==n}))}function Y(n){if(Array.isArray(n))return n}function D(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}function q(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function J(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=new Array(t);r<t;r++)e[r]=n[r];return e}function W(n,t){if(n){if("string"==typeof n)return J(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(n,t):void 0}}function F(n,t){return Y(n)||D(n)||W(n,t)||q()}var V,X,Z,$,K,Q="row_index",nn="column_index",tn="5px",rn="2px",en="7357f676-a003-4524-a931-1316d9efb156",on=function(){return G().leftEyeColor},un=function(){return G().rightEyeColor},cn=(n($={},g,(n(V={},O,[[N,"white"]]),n(V,T,[[I,"black"],[L,"1vh solid black"]]),n(V,_,[[I,"black"],[M,"".concat(tn," solid black")],[j,"-".concat(tn)]]),n(V,k,[[N,"white"],[M,"".concat(tn," solid black")],[j,"-".concat(tn)]]),n(V,S,[[N,"black"]]),n(V,C,[[N,"white"]]),n(V,A,[[M,"".concat(rn," solid black")],[j,"-".concat(rn)]]),V)),n($,w,(n(X={},O,[[N,"black"]]),n(X,T,[[I,"white"],[L,"1vh solid white"]]),n(X,_,[[I,"white"],[M,"".concat(tn," solid white")],[j,"-".concat(tn)]]),n(X,k,[[N,"black"],[M,"".concat(tn," solid white")],[j,"-".concat(tn)]]),n(X,S,[[N,"white"]]),n(X,C,[[N,"black"]]),n(X,A,[[I,"white"],[M,"".concat(rn," solid white")],[j,"-".concat(rn)]]),X)),n($,E,(n(Z={},O,[[N,"black"]]),n(Z,T,[[I,on],[L,function(){return"1vh solid ".concat(un())}]]),n(Z,_,[[I,on],[M,function(){return"".concat(rn," solid ").concat(un())}],[j,"-".concat(rn)]]),n(Z,k,[[N,on]]),n(Z,S,[[N,un]]),n(Z,C,[[N,"black"]]),n(Z,A,[[I,on],[M,function(){return"".concat(rn," solid ").concat(un())}],[j,"-".concat(rn)]]),Z)),$),an=function(n,t){return cn[t]&&cn[t][n]?cn[t][n]:[]},ln=function(n,t){Object.values(cn).forEach((function(t){Object.values(t).forEach((function(t){for(var r=0;r<t.length;r+=1)n.style[t[r][0]]=""}))})),t.forEach((function(t){var r=F(t,2),e=r[0],o=r[1],i="function"==typeof o?o():o;a(n,e,i)}))},fn="whole_cross",dn="random",sn=(n(K={},fn,(function(n,t){return function(r,e){for(var o=function(n){i.some((function(t){var e=F(t,2),o=e[0],i=e[1];return o===r&&i===n}))||i.push([r,n])},i=[],u=0;u<n;u+=1)i.push([u,e]);for(var c=0;c<t;c+=1)o(c);return i}})),n(K,"small_cross",(function(n,t){return function(r,e){return[[0,0],[-1,0],[1,0],[0,-1],[0,1]].filter((function(o){return o[0]+r<n&&o[1]+e<t})).filter((function(n){return n[0]+r>=0&&n[1]+e>=0})).map((function(n){return[n[0]+r,n[1]+e]}))}})),n(K,"inverted_cross",(function(n,t){return function(r,e){return[[0,0],[-1,-1],[-1,1],[1,-1],[1,1]].filter((function(o){return o[0]+r<n&&o[1]+e<t})).filter((function(n){return n[0]+r>=0&&n[1]+e>=0})).map((function(n){return[n[0]+r,n[1]+e]}))}})),n(K,dn,(function(n,t){var r=Object.keys(sn).filter((function(n){return n!==dn})),e=r[Math.floor(Math.random()*r.length)];return sn[e](n,t)})),K);function hn(n){if(Array.isArray(n))return J(n)}function vn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mn(n){return hn(n)||D(n)||W(n)||vn()}var bn=function(n,t,r,e){var o=sn[r](e.length,e[0].length),i=e.map((function(n){return n.map((function(n){return n}))}));return o(n,t).forEach((function(n){var t=F(n,2),r=t[0],o=t[1];i[r][o]=!e[r][o]})),i},pn=function(n,t,r){var e=r.board,o=r.pattern,i=r.moves;return{board:bn(n,t,o,e),moves:mn(i).concat([[n,t]])}},yn=function(n){var t=n.board,r=n.pattern,e=n.moves;if(0===e.length)return{board:t,moves:e};var o=mn(e),i=F(o.pop(),2),u=i[0],c=i[1];return{board:bn(u,c,r,t),moves:o}},gn=function(n){for(var t=n.board,r=n.pattern,e=mn(n.moves),o=t.map((function(n){return n.map((function(n){return n}))}));e.length>0;){var i=yn({board:o,pattern:r,moves:e});o=i.board,e=i.moves}return{board:o,moves:e}},wn=function(n,t,r,e){return{rows:n,columns:t,stepsToSolve:r,pattern:e}},En=wn(4,4,5,fn),kn=wn(5,5,10,fn),Sn=wn(7,7,20,fn),Cn=function(n,t,r){var e=function(n){return Math.floor(Math.random()*n)};return mn(Array(n)).map((function(){return[e(t),e(r)]}))},On=function(n){var r=function(n){for(var t=n.rows,r=n.columns,e=n.stepsToSolve,o=n.pattern,i=mn(Array(t)).map((function(){return Array(r).fill(!0)})),u=Cn(e,t,r),c=0;c<u.length;c+=1){var a=F(u[c],2),l=a[0],f=a[1];i=bn(l,f,o,i)}return{board:i,solution:u,pattern:o}}(t({},n)),e=r.board;B({solution:r.solution,pattern:r.pattern,moves:[]}),z({board:e},!1)},Tn=function(n){return B({location:n})},_n=function(n){return B({theme:n})},An=function(n,t){var r=t.width,e=t.height,o=t.margin;a(n,"width",r),a(n,"height",e),a(n,"margin",o)},Nn=function(n){var t=n.length,r=window.innerWidth<window.innerHeight?"vw":"vh",e=Math.floor(90/t*.95);return{margin:.05*e+r,width:e+r,height:e+r}},Ln=function(n){var r,e,o=n.target,i=G(),c=parseInt(u(o,Q),10),a=parseInt(u(o,nn),10);B(t({},pn(c,a,i))),G().board.every((function(n){return n.every((function(n){return n}))}))&&(r=function(){return Tn(m)},e=500,window.setTimeout(r,e))},Mn=function(n,t){return ln(n,an(C,t))},jn=function(n,t,r){ln(n,an(t?k:S,r))},In=function(){var n=function(n){var a=function(e){var a=r("div");o(a).add("cell"),i(a,Q,n),i(a,nn,e),c(a,"click",Ln),An(a,Nn(u)),jn(a,t.board[n][e],t.theme),P(["board"],(function(t){return jn(a,t.board[n][e],t.theme)}),"cell-board-observer"),l.appendChild(a)},l=r("div");o(l).add("row");for(var f=0;f<u[n].length;f+=1)a(f);e.appendChild(l)};H("board-theme-observer"),H("cell-board-observer");var t=G(),e=r("div");o(e).add("board"),Mn(e,t.theme),P(["theme"],(function(n){var t=n.theme;return Mn(e,t)}),"board-theme-observer");for(var u=G().board,a=0;a<u.length;a+=1)n(a);return e},Rn=function(){var n;(n=".cell",document.querySelectorAll(n)).forEach((function(n){var t=G().board;An(n,Nn(t))}))},xn={currentLocation:null,map:{}};function Un(n,t){Object.assign(xn.map,t);P(["location"],(function(n){var t=n.location;if(t!==xn.currentLocation){var r=e("#root");r.innerHTML="";var o=xn.map[t];o="function"==typeof o?o():o,r.appendChild(o),xn.currentLocation=t}})),B({location:n})}function zn(n){var t=r("div");return o(t).add("ui-menu"),n&&n.forEach((function(n){return t.appendChild(n)})),ln(t,an(O,G().theme)),P(["theme"],(function(n){var r=n.theme;ln(t,an(O,r))}),"menu-theme-observer"),t}function Bn(n,t){var e=r("button");return e.innerText=n,e.onclick=t,o(e).add("ui-menu-item"),ln(e,an(_,G().theme)),P(["theme"],(function(n){var t=n.theme;ln(e,an(_,t))}),"menu-item-theme-observer"),e}function Gn(n){var t=r("button");return t.innerText=n,t.disabled=!0,o(t).add("ui-menu-title"),ln(t,an(T,G().theme)),P(["theme"],(function(n){var r=n.theme;ln(t,an(T,r))}),"menu-theme-observer"),t}var Pn=24,Hn=function(n){var t=255/(Pn/2);return n<Pn/2?"rgb(".concat(255-n*t,",0,0)"):"rgb(0,0,".concat((n-Pn/2)*t,")")},Yn=function(n,t){for(var r=t/(Pn+1),e=1;n>r*e;)e+=1;return Hn(e-1)};function Dn(n){var t=r("canvas");o(t).add("color-picker");for(var e=t.getContext("2d"),i=t.width/(Pn+1),u=0;u<=Pn;u+=1)e.fillStyle=Hn(u),e.fillRect(u*i,0,i,t.height);return c(t,"click",(function(r){var e=r.clientX;if(t){var o=t.getBoundingClientRect(),i=o.left,u=o.width,c=Yn(e-i,u);n(c)}})),t}function qn(n){var t=r("canvas");return o(t).add("color-indicator"),P([],(function(r){if(t){var e=n(r),o=t.getContext("2d");o.fillStyle=e,o.fillRect(0,0,t.width,t.height)}})),t}function Jn(n,t){var e=r("button");return o(e).add("status-line-button"),e.innerHTML=n,e.onclick=t,ln(e,an(A,G().theme)),e}var Wn=function(){var n=G();B(t({},yn(n)))};function Fn(){var n=r("div");return o(n).add("status-line"),n.appendChild(Jn("back",(function(){return Tn(f)}))),n.appendChild(Jn("undo",Wn)),n.appendChild(Jn("reset",(function(){return Tn(v)}))),n}function Vn(){var n=r("div");return a(n,"height","100%"),n.appendChild(In()),n.appendChild(Fn()),n}function Xn(){var n,t=zn();return t.appendChild(Gn("Renverso")),t.appendChild(Bn("New game",(function(){return Tn(d)}))),t.appendChild((n=Bn("Continue",(function(){return Tn(h)})),a(n,"display","none"),P(["pattern"],(function(t){var r=t.pattern;a(n,"display",null===r?"none":"block")})),n)),t.appendChild(Bn("Color theme",(function(){return Tn(s)}))),t}var Zn=function(){var n=G();B(t({},gn(n))),Tn(h)};var $n=function(){B({board:[],moves:[],solution:[],pattern:null,location:f})},Kn=function(n){return"move".concat(n.length>1?"s":"")};var Qn=function(n){On(n),Tn(h)};window.onresize=function(){Rn()},window.onload=function(){var r;Un(f,(n(r={},h,(function(){return Vn()})),n(r,f,Xn()),n(r,v,zn([Gn("Do you want to reset level progress?"),Bn("Yes",(function(){return Zn()})),Bn("No",(function(){return Tn(h)}))])),n(r,m,(function(){return n=G().moves,zn([Gn("Puzzle solved in ".concat(n.length," ").concat(Kn(n),"!")),Bn("To main menu",$n)]);var n})),n(r,s,zn([Gn("Select color theme"),Bn("Light",(function(){return _n(g)})),Bn("Dark",(function(){return _n(w)})),Bn("Lazy eye",(function(){return Tn(b)})),Bn("Back",(function(){return Tn(f)}))])),n(r,d,zn([Gn("Select level"),Bn("Easy",(function(){return Qn(En)})),Bn("Medium",(function(){return Qn(kn)})),Bn("Hard",(function(){return Qn(Sn)})),Bn("Back",(function(){return Tn(f)}))])),n(r,b,zn([Gn("Lazy eye coloring settings"),Bn("Left eye color",(function(){return Tn(p)})),Bn("Right eye color",(function(){return Tn(y)})),Bn("Apply",(function(){return _n(E)})),Bn("Back",(function(){return Tn(s)}))])),n(r,p,zn([Gn("Left eye color"),qn((function(n){return n.leftEyeColor})),Dn((function(n){return B({leftEyeColor:n})})),Bn("Back",(function(){return Tn(b)}))])),n(r,y,zn([Gn("Right eye color"),qn((function(n){return n.rightEyeColor})),Dn((function(n){return B({rightEyeColor:n})})),Bn("Back",(function(){return Tn(b)}))])),r));var e,o=(e=en,window.localStorage.getItem(e));B(null!==o?t({},JSON.parse(o)):{theme:"light"}),P(Object.keys(G()),(function(n){return l(en,JSON.stringify(n))}))}}();